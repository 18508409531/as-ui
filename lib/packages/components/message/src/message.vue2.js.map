{"version":3,"file":"message.vue2.js","sources":["../../../../../../../packages/components/message/src/message.vue"],"sourcesContent":["<template>\n  <transition\n    :name=\"ns.b('fade')\"\n    @before-leave=\"onClose\"\n    @after-leave=\"$emit('destroy')\"\n  >\n    <div\n      v-show=\"visible\"\n      :id=\"id\"\n      ref=\"messageRef\"\n      :class=\"[\n        ns.b(),\n        ns.m(type),\n        ns.is('center', center),\n        ns.is('showClose', showClose)\n      ]\"\n      :style=\"customStyle\"\n      @mouseenter=\"clearTimer\"\n      @mouseleave=\"startTimer\"\n    >\n      <as-icon :class=\"[iconComponent, ns.e('icon')]\" />\n      <slot>\n        <p v-if=\"!dangerouslyUseHTMLString\" :class=\"ns.e('content')\">\n          {{ message }}\n        </p>\n        <p v-else :class=\"ns.e('content')\" v-html=\"message\" />\n      </slot>\n      <div v-if=\"showClose\" :class=\"ns.e('closeBtn')\" @click.stop=\"close\">\n        <as-icon class=\"as-ui-chahao1\"></as-icon>\n      </div>\n    </div>\n  </transition>\n</template>\n\n<script lang=\"ts\" setup>\nimport { onMounted, ref, computed } from 'vue'\nimport type { CSSProperties } from 'vue'\nimport { messageProps, iconMaps } from './common'\nimport { useNamespace } from '@as-ui/utils/bem'\nimport { useTimeoutFn, useResizeObserver } from '@vueuse/core'\nimport { getLastOffset } from './instance'\nimport AsIcon from '../../icon/src/icon.vue'\n\nconst props = defineProps(messageProps)\ndefineEmits(['destroy'])\nconst ns = useNamespace('message')\nconst visible = ref(false)\nconst height = ref(0)\nconst messageRef = ref<HTMLDivElement>()\nlet stopTimer: (() => void) | undefined = undefined\n\nfunction startTimer() {\n  if (props.duration === 0) return\n  ;({ stop: stopTimer } = useTimeoutFn(() => {\n    close()\n  }, props.duration))\n}\n\nconst iconComponent = computed(\n  () => props.icon || iconMaps[props.type] || 'success'\n)\n\nconst lastOffset = computed(() => getLastOffset(props.id))\nconst offset = computed(() => props.offset + lastOffset.value)\nconst bottom = computed((): number => height.value + offset.value)\nconst customStyle = computed<CSSProperties>(() => ({\n  top: `${offset.value}px`\n}))\nfunction clearTimer() {\n  stopTimer?.()\n}\n\nfunction close() {\n  visible.value = false\n}\n\nuseResizeObserver(messageRef, () => {\n  height.value = messageRef.value!.getBoundingClientRect().height\n})\n\nonMounted(() => {\n  startTimer()\n  visible.value = true\n})\n\ndefineExpose({\n  visible,\n  bottom,\n  close\n})\n</script>\n"],"names":["useNamespace","ref","useTimeoutFn","computed","iconMaps","getLastOffset","useResizeObserver","onMounted"],"mappings":";;;;;;;;;;;;;;;;;;;;AA6CA,IAAM,MAAA,EAAA,GAAKA,iBAAa,SAAS,CAAA,CAAA;AACjC,IAAM,MAAA,OAAA,GAAUC,QAAI,KAAK,CAAA,CAAA;AACzB,IAAM,MAAA,MAAA,GAASA,QAAI,CAAC,CAAA,CAAA;AACpB,IAAA,MAAM,aAAaA,OAAoB,EAAA,CAAA;AACvC,IAAA,IAAI,SAAsC,GAAA,KAAA,CAAA,CAAA;AAE1C,IAAA,SAAS,UAAa,GAAA;AACpB,MAAA,IAAI,MAAM,QAAa,KAAA,CAAA;AAAG,QAAA,OAAA;AACzB,MAAA,CAAC,EAAE,IAAA,EAAM,SAAU,EAAA,GAAIC,kBAAa,MAAM;AACzC,QAAM,KAAA,EAAA,CAAA;AAAA,OACR,EAAG,MAAM,QAAQ,CAAA,EAAA;AAAA,KACnB;AAEA,IAAA,MAAM,aAAgB,GAAAC,YAAA;AAAA,MACpB,MAAM,KAAA,CAAM,IAAQ,IAAAC,eAAA,CAAS,MAAM,IAAS,CAAA,IAAA,SAAA;AAAA,KAC9C,CAAA;AAEA,IAAA,MAAM,aAAaD,YAAS,CAAA,MAAME,sBAAc,CAAA,KAAA,CAAM,EAAE,CAAC,CAAA,CAAA;AACzD,IAAA,MAAM,SAASF,YAAS,CAAA,MAAM,KAAM,CAAA,MAAA,GAAS,WAAW,KAAK,CAAA,CAAA;AAC7D,IAAA,MAAM,SAASA,YAAS,CAAA,MAAc,MAAO,CAAA,KAAA,GAAQ,OAAO,KAAK,CAAA,CAAA;AACjE,IAAM,MAAA,WAAA,GAAcA,aAAwB,OAAO;AAAA,MACjD,GAAA,EAAK,GAAG,MAAO,CAAA,KAAA,CAAA,EAAA,CAAA;AAAA,KACf,CAAA,CAAA,CAAA;AACF,IAAA,SAAS,UAAa,GAAA;AACpB,MAAA,SAAA,IAAA,IAAA,GAAA,KAAA,CAAA,GAAA,SAAA,EAAA,CAAA;AAAA,KACF;AAEA,IAAA,SAAS,KAAQ,GAAA;AACf,MAAA,OAAA,CAAQ,KAAQ,GAAA,KAAA,CAAA;AAAA,KAClB;AAEA,IAAAG,sBAAA,CAAkB,YAAY,MAAM;AAClC,MAAA,MAAA,CAAO,KAAQ,GAAA,UAAA,CAAW,KAAO,CAAA,qBAAA,EAAwB,CAAA,MAAA,CAAA;AAAA,KAC1D,CAAA,CAAA;AAED,IAAAC,aAAA,CAAU,MAAM;AACd,MAAW,UAAA,EAAA,CAAA;AACX,MAAA,OAAA,CAAQ,KAAQ,GAAA,IAAA,CAAA;AAAA,KACjB,CAAA,CAAA;AAED,IAAa,MAAA,CAAA;AAAA,MACX,OAAA;AAAA,MACA,MAAA;AAAA,MACA,KAAA;AAAA,KACD,CAAA,CAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;"}